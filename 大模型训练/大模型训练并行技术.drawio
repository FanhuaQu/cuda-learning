<mxfile host="Electron" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/28.0.6 Chrome/138.0.7204.100 Electron/37.2.3 Safari/537.36" version="28.0.6">
  <diagram name="第 1 页" id="EWJQIrNWfICb7iIzTn4a">
    <mxGraphModel dx="595" dy="362" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="oowebGv03fU5Xog6vTBj-1" value="" style="shape=table;startSize=0;container=1;collapsible=0;childLayout=tableLayout;" vertex="1" parent="1">
          <mxGeometry x="163" y="116" width="60" height="160" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-2" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-1">
          <mxGeometry width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-3" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#6c8ebf;overflow=hidden;fillColor=#dae8fc;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-2">
          <mxGeometry width="60" height="40" as="geometry">
            <mxRectangle width="60" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-4" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-1">
          <mxGeometry y="40" width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-5" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-4">
          <mxGeometry width="60" height="40" as="geometry">
            <mxRectangle width="60" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-6" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-1">
          <mxGeometry y="80" width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-7" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-6">
          <mxGeometry width="60" height="40" as="geometry">
            <mxRectangle width="60" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-8" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-1">
          <mxGeometry y="120" width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-9" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-8">
          <mxGeometry width="60" height="40" as="geometry">
            <mxRectangle width="60" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-10" value="" style="shape=table;startSize=0;container=1;collapsible=0;childLayout=tableLayout;" vertex="1" parent="1">
          <mxGeometry x="254" y="116" width="60" height="160" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-11" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-10">
          <mxGeometry width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-12" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-11">
          <mxGeometry width="60" height="40" as="geometry">
            <mxRectangle width="60" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-13" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-10">
          <mxGeometry y="40" width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-14" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#6c8ebf;overflow=hidden;fillColor=#dae8fc;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-13">
          <mxGeometry width="60" height="40" as="geometry">
            <mxRectangle width="60" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-15" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-10">
          <mxGeometry y="80" width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-16" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-15">
          <mxGeometry width="60" height="40" as="geometry">
            <mxRectangle width="60" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-17" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-10">
          <mxGeometry y="120" width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-18" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-17">
          <mxGeometry width="60" height="40" as="geometry">
            <mxRectangle width="60" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-28" value="" style="shape=table;startSize=0;container=1;collapsible=0;childLayout=tableLayout;" vertex="1" parent="1">
          <mxGeometry x="345" y="116" width="60" height="160" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-29" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-28">
          <mxGeometry width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-30" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-29">
          <mxGeometry width="60" height="40" as="geometry">
            <mxRectangle width="60" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-31" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-28">
          <mxGeometry y="40" width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-32" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-31">
          <mxGeometry width="60" height="40" as="geometry">
            <mxRectangle width="60" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-33" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-28">
          <mxGeometry y="80" width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-34" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#6c8ebf;overflow=hidden;fillColor=#dae8fc;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-33">
          <mxGeometry width="60" height="40" as="geometry">
            <mxRectangle width="60" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-35" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-28">
          <mxGeometry y="120" width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-36" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-35">
          <mxGeometry width="60" height="40" as="geometry">
            <mxRectangle width="60" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-37" value="" style="shape=table;startSize=0;container=1;collapsible=0;childLayout=tableLayout;" vertex="1" parent="1">
          <mxGeometry x="435" y="116" width="60" height="160" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-38" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-37">
          <mxGeometry width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-39" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-38">
          <mxGeometry width="60" height="40" as="geometry">
            <mxRectangle width="60" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-40" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-37">
          <mxGeometry y="40" width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-41" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-40">
          <mxGeometry width="60" height="40" as="geometry">
            <mxRectangle width="60" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-42" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-37">
          <mxGeometry y="80" width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-43" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-42">
          <mxGeometry width="60" height="40" as="geometry">
            <mxRectangle width="60" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-44" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=#6c8ebf;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=#dae8fc;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-37">
          <mxGeometry y="120" width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-45" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-44">
          <mxGeometry width="60" height="40" as="geometry">
            <mxRectangle width="60" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-46" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="134" y="116" width="20" height="160" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-48" value="vocab" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="84" y="179" width="50" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-49" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;flipH=0;flipV=0;direction=south;" vertex="1" parent="1">
          <mxGeometry x="163" y="90" width="60" height="20" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-50" value="hidden" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="169" y="64" width="54" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-51" value="Rank0" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="166" y="276" width="53" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-52" value="Rank1" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="256.5" y="276" width="53" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-53" value="Rank2" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="347.5" y="276" width="53" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-54" value="Rank3" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="437.5" y="276" width="53" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-56" value="attention是怎么算的，一个多头注意力(MHA)计算如下" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="154.62" y="392" width="303" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-57" value="" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="298.62" y="435" as="sourcePoint" />
            <mxPoint x="300.62" y="493" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-58" value="[batch_size, seq_len, hidden_dim]" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="310.62" y="438" width="199" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-59" value="WQ" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="192.62" y="499" width="67" height="22" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-60" value="WK" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="266.62" y="499" width="67" height="22" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-61" value="WV" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="340.62" y="499" width="67" height="22" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-62" value="线性投影层" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="105.62" y="497" width="78" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-63" value="Q" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="212.62" y="536" width="27" height="20" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-64" value="K" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="286.62" y="536" width="27" height="20" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-65" value="V" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="360.62" y="536" width="27" height="20" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-66" value="[batch_size, seq_len, num_heads, head_dim]&lt;div&gt;这里hidden_dim = num_heads * head_dim&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;labelBackgroundColor=#D5E8D4;" vertex="1" parent="1">
          <mxGeometry x="395.62" y="526" width="260" height="41" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-67" value="atten = softmax(QK^T)/sqrt(head_dim)&lt;div&gt;O = atten @ V&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="183.62" y="572" width="236" height="35" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-68" value="atttention" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="108.62" y="573" width="67" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-70" value="将前面的所有结果拼接回去，尺寸是&lt;span style=&quot;text-wrap-mode: nowrap;&quot;&gt;[batch_size, seq_len, hidden_dim]&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="174" y="617" width="252.25" height="32" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-71" value="O_proj = O @ W_out" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="230.62" y="655" width="123.5" height="27" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-72" value="投影输出" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="109.12" y="656" width="66" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-73" value="多头输出拼接" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="84" y="620" width="90" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-74" value="TP的时候可以按照head切&lt;div&gt;实际上就是列切&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="437.5" y="569" width="156" height="41" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-75" value="这里权重也是按列切&lt;div&gt;最后输出需要做一次all-reduce&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="400.62" y="648" width="179" height="41" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-76" value="attention 后面跟的是FFN&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="117.12" y="758" width="151" height="41" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-77" value="" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="184.62" y="792" as="sourcePoint" />
            <mxPoint x="186.62" y="850" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-78" value="[B,S,H]" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="200.5" y="799" width="56" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-79" value="W1&amp;nbsp;∈ [H, 4H]" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="142.62" y="863" width="100" height="21" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-80" value="&lt;font style=&quot;font-size: 8px; background-color: rgb(213, 232, 212);&quot;&gt;第一个线性层，扩大维度&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="34.120000000000005" y="860.5" width="106" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-81" value="" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="187.37" y="892" as="sourcePoint" />
            <mxPoint x="188.87" y="952" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-82" value="[B,S,4H]" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="202.74" y="900" width="63" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-83" value="W1&amp;nbsp;∈ [4H, H]" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="140.12" y="957" width="100" height="21" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-84" value="&lt;font style=&quot;font-size: 8px; background-color: rgb(213, 232, 212);&quot;&gt;第二个线性层，缩小维度&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="36.620000000000005" y="954.5" width="106" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-85" value="" style="shape=table;startSize=0;container=1;collapsible=0;childLayout=tableLayout;" vertex="1" parent="1">
          <mxGeometry x="315" y="804" width="80" height="20" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-86" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-85">
          <mxGeometry width="80" height="20" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-87" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#82b366;overflow=hidden;fillColor=#d5e8d4;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-86">
          <mxGeometry width="20" height="20" as="geometry">
            <mxRectangle width="20" height="20" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-88" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-86">
          <mxGeometry x="20" width="20" height="20" as="geometry">
            <mxRectangle width="20" height="20" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-89" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-86">
          <mxGeometry x="40" width="20" height="20" as="geometry">
            <mxRectangle width="20" height="20" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-90" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-86">
          <mxGeometry x="60" width="20" height="20" as="geometry">
            <mxRectangle width="20" height="20" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-91" value="" style="shape=table;startSize=0;container=1;collapsible=0;childLayout=tableLayout;" vertex="1" parent="1">
          <mxGeometry x="315" y="840" width="20" height="30" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-92" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-91">
          <mxGeometry width="20" height="30" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-93" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#b85450;overflow=hidden;fillColor=#f8cecc;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-92">
          <mxGeometry width="20" height="30" as="geometry">
            <mxRectangle width="20" height="30" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-95" value="" style="shape=table;startSize=0;container=1;collapsible=0;childLayout=tableLayout;" vertex="1" parent="1">
          <mxGeometry x="282.62" y="840" width="20" height="30" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-96" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=#82b366;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=#d5e8d4;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-95">
          <mxGeometry width="20" height="30" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-97" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-96">
          <mxGeometry width="20" height="30" as="geometry">
            <mxRectangle width="20" height="30" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-98" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="266.62" y="840" width="10" height="30" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-100" value="&lt;font style=&quot;font-size: 8px;&quot;&gt;S&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="249" y="837.5" width="23" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-101" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;size=0.5;direction=south;" vertex="1" parent="1">
          <mxGeometry x="282.62" y="826" width="20" height="10" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-102" value="&lt;font style=&quot;font-size: 8px;&quot;&gt;H&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="280.62" y="804" width="24" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-103" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;size=0.5;direction=south;" vertex="1" parent="1">
          <mxGeometry x="315" y="791" width="20" height="10" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-104" value="&lt;font style=&quot;font-size: 8px;&quot;&gt;4H/TP&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="304" y="765.5" width="41" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-105" value="&lt;font style=&quot;font-size: 8px; background-color: rgb(213, 232, 212);&quot;&gt;&lt;font style=&quot;&quot;&gt;每张卡的输出&lt;br&gt;[B,S,4H/TP&lt;/font&gt;]&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;" vertex="1" parent="1">
          <mxGeometry x="332.5" y="830" width="66" height="41" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-106" value="" style="shape=table;startSize=0;container=1;collapsible=0;childLayout=tableLayout;" vertex="1" parent="1">
          <mxGeometry x="282.37" y="911" width="20" height="30" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-107" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-106">
          <mxGeometry width="20" height="30" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-108" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#b85450;overflow=hidden;fillColor=#f8cecc;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-107">
          <mxGeometry width="20" height="30" as="geometry">
            <mxRectangle width="20" height="30" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-109" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;size=0.5;direction=south;" vertex="1" parent="1">
          <mxGeometry x="282.87" y="901" width="20" height="10" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-110" value="&lt;font style=&quot;font-size: 8px;&quot;&gt;4H/TP&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="271.87" y="875.5" width="41" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-111" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="270.62" y="912.25" width="10" height="30" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-112" value="&lt;font style=&quot;font-size: 8px;&quot;&gt;S&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="253" y="909.75" width="23" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-113" value="" style="shape=table;startSize=0;container=1;collapsible=0;childLayout=tableLayout;" vertex="1" parent="1">
          <mxGeometry x="357.69" y="897" width="20" height="80" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-114" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-113">
          <mxGeometry width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-115" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#b85450;overflow=hidden;fillColor=#f8cecc;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-114">
          <mxGeometry width="20" height="20" as="geometry">
            <mxRectangle width="20" height="20" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-116" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-113">
          <mxGeometry y="20" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-117" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-116">
          <mxGeometry width="20" height="20" as="geometry">
            <mxRectangle width="20" height="20" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-118" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-113">
          <mxGeometry y="40" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-119" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-118">
          <mxGeometry width="20" height="20" as="geometry">
            <mxRectangle width="20" height="20" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-120" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-113">
          <mxGeometry y="60" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-121" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-120">
          <mxGeometry width="20" height="20" as="geometry">
            <mxRectangle width="20" height="20" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-122" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="343.31" y="897" width="10" height="20" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-123" value="&lt;font style=&quot;font-size: 8px;&quot;&gt;4H/TP&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="312.31" y="891" width="41" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-124" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;size=0.5;direction=south;" vertex="1" parent="1">
          <mxGeometry x="357.69" y="885" width="20" height="10" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-125" value="&lt;font style=&quot;font-size: 8px;&quot;&gt;H&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="355.69" y="863" width="24" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-126" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="387.62" y="926" as="sourcePoint" />
            <mxPoint x="422" y="926" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-127" value="" style="shape=table;startSize=0;container=1;collapsible=0;childLayout=tableLayout;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="453.24" y="916" width="20" height="30" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-128" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=#82b366;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=#d5e8d4;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="oowebGv03fU5Xog6vTBj-127">
          <mxGeometry width="20" height="30" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-129" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#9673a6;overflow=hidden;fillColor=#e1d5e7;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" parent="oowebGv03fU5Xog6vTBj-128">
          <mxGeometry width="20" height="30" as="geometry">
            <mxRectangle width="20" height="30" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-130" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="437.24" y="916" width="10" height="30" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-131" value="&lt;font style=&quot;font-size: 8px;&quot;&gt;S&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="419.62" y="913.5" width="23" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-132" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;size=0.5;direction=south;" vertex="1" parent="1">
          <mxGeometry x="453.24" y="902" width="20" height="10" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-133" value="&lt;font style=&quot;font-size: 8px;&quot;&gt;H&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="451.24" y="880" width="24" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-135" value="&lt;font style=&quot;font-size: 8px; background-color: rgb(213, 232, 212);&quot;&gt;第一层权重按照列切&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="400.62" y="798" width="90" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-136" value="&lt;font style=&quot;font-size: 8px; background-color: rgb(213, 232, 212);&quot;&gt;第二层权重按照行切&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="392" y="865" width="90" height="26" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-137" value="&lt;font style=&quot;font-size: 8px; background-color: rgb(213, 232, 212);&quot;&gt;最终每张卡的输出是完整输出的一部分&lt;/font&gt;&lt;div&gt;&lt;span style=&quot;font-size: 8px; background-color: rgb(213, 232, 212);&quot;&gt;需要经过一次all-reduce&lt;/span&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="386.24" y="949" width="154" height="41" as="geometry" />
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-138" value="" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="189.12" y="983" as="sourcePoint" />
            <mxPoint x="191.12" y="1041" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oowebGv03fU5Xog6vTBj-139" value="[B,S,H]" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="202.74" y="990" width="56" height="26" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
