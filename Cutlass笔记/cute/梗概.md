# what's cute?

cute是C++ cuda 模板抽象的集合(C++ cuda template)，用于定义和操作线程和数据的多维多层布局。Cute提供了Layout和Tensor对象，是对数据类型、形状、内存空间和布局的封装。掌握cute之后，程序员可以专注于算法的逻辑描述，快速设计、实现和修改密集的线性代数运算。

CuTe 的核心抽象是分层的多维布局，可以与数据数组组成来表示张量。可以简单理解为：**张量Tnesor = 数据 + Layout**。



# 目录

cute的单元测试文件位于`test/unit/cute`

```bash
tree -d test/unit/cute/
test/unit/cute/
|-- ampere
|-- core
|-- hopper
|-- layout
|-- msvc_compilation
|-- turing
`-- volta
```

example文件位于`example/cute`目录下

```bash
tree  examples/cute
examples/cute
|-- CMakeLists.txt
`-- tutorial
    |-- CMakeLists.txt
    |-- sgemm_1.cu
    |-- sgemm_2.cu
    |-- sgemm_sm70.cu
    |-- sgemm_sm80.cu
    |-- tiled_copy.cu
    `-- wgmma_sm90.cu
```



# Library Organization

Cute和cutlass一样都是header-only的C++库，包含在`include/cute`目录中

* `include/cute`

包含Layout和Tensor的实现

* `include/cute/container`

STL-like的对象，包括`tuple`、`array`、`aligned array`等

* `include/cute/numeric`

基本数字数据类型，包括非标准浮点类型、非标准整数类型、复数和整数序列。

* `include/cute/algorithm`

复制、填充和清除等实用程序算法的实现，这些算法会自动利用特定于体系结构的功能（如果可用）。

* `include/cute/arch`

特定架构的gemm和copy指令封装

* `include/cute/atom`

arch中指令和程序的元信息，例如(分区、平铺)



# tutorial

依次包含

* Layout
* Tensor
* mma
* tma等



# Tips

打印cute对象

`cute::print`重载了几乎所有的cute类型，包括Pointers、Integers、Strides、Shapes、Layouts 和 Tensors

threadx和blockx

在文件`include/cute/util/debug.hpp`

```c++
if (thread0()) {
  print(some_cute_object);
}

CUTE_HOST_DEVICE
bool
block([[maybe_unused]] int bid)
{
#if defined(__CUDA_ARCH__)
  return blockIdx.x + blockIdx.y*gridDim.x + blockIdx.z*gridDim.x*gridDim.y == static_cast<unsigned int>(bid);
#else
  return true;
#endif
}

CUTE_HOST_DEVICE
bool
thread([[maybe_unused]] int tid, [[maybe_unused]] int bid)
{
#if defined(__CUDA_ARCH__)
  return (threadIdx.x + threadIdx.y*blockDim.x + threadIdx.z*blockDim.x*blockDim.y == static_cast<unsigned int>(tid)) && block(bid);
#else
  return true;
#endif
}

CUTE_HOST_DEVICE
bool
thread(int tid)
{
  return thread(tid,0);
}

CUTE_HOST_DEVICE
bool
thread0()
{
  return thread(0,0);
}

CUTE_HOST_DEVICE
bool
block0()
{
  return block(0);
}
```



# 其他

* 使用`cute::print_layout`打印二维排布
* 使用`cute::print_tensor`打印张量的值
* 使用`cute::print_latex`打印Latex命令

